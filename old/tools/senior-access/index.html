<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eduthing tool repo - Senior Access</title>
</head>
<body>
    <h1>eduthing tool repo - Senior Access</h1>
    <ul id="file-list"></ul>

    <script>
async function listFiles() {
    const apiUrl = "https://minmfcv0i2.execute-api.eu-west-2.amazonaws.com/prod/ListS3Files-Senior";
    
    try {
        const response = await fetch(apiUrl);
        const files = await response.json();
        
        let fileList = document.getElementById("file-list");
        fileList.innerHTML = ""; // Clear existing list before appending

        files.forEach(file => {
            let li = document.createElement("li");

            let key = file.Key;
            let isDirectory = key.endsWith("/");
            
            // Extract only the last part of the path
            let parts = key.split("/");
            let displayName = isDirectory ? parts[parts.length - 2] : parts[parts.length - 1];

            // Count folder depth (ignoring trailing slash for directories)
            let depth = (key.match(/\//g) || []).length - (isDirectory ? 1 : 0);

            // Apply indentation
            li.style.paddingLeft = `${depth * 20}px`;

            if (isDirectory) {
                li.textContent = displayName; // Show only the bottom folder name
                li.style.fontWeight = "bold"; // Highlight directories
            } else {
                let link = document.createElement("a");
                link.href = file.URL;
                link.textContent = displayName;
                li.appendChild(link);
            }

            fileList.appendChild(li);
        });
    } catch (error) {
        console.error("Error fetching files:", error);
    }
}

        listFiles();
    </script>
    <p>Maintained and update by <a href="mailto:nbendall@eduthing.co.uk">NJ Bendall</a>.</p>
</body>
</html>
